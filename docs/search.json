[{"path":"index.html","id":"intro","chapter":"1 Introduction","heading":"1 Introduction","text":"personal collection statistical notes citations \nserves reference can use helping natural scientists statistics R.intended Statistical Textbook. lots ,\nmany freely available online. found lack , clear instructions\napply , almost importantly, interpret statistics R.\nalso found lack list simple best practices.Consider Practical Guide performing statistics R Natural Scientists.\nplaces include statistical guidance, generally speaking assume\nbackground statistics. source understanding underlying\ntheory statistics!Everywhere possible cite information stackoverflow question \nacademic journal article.\ncitation think include think ‚Äôs something ‚Äôm missing,\nplease open issue GitHub repository let know (ideally citation!)work progress! sections brief, unfinished","code":""},{"path":"index.html","id":"getting-started","chapter":"1 Introduction","heading":"1.1 Getting Started","text":"Throughout examples ‚Äôll using awesome palmerpenguins package example data.\nFigure 1.1: Artwork Allison Horst\nCheck data:","code":"\nlibrary(palmerpenguins)\npenguins## # A tibble: 344 √ó 9\n##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g sex     year size \n##    <fct>   <fct>              <dbl>         <dbl>             <int>       <int> <fct>  <int> <lgl>\n##  1 Adelie  Torgersen           39.1          18.7               181        3750 male    2007 FALSE\n##  2 Adelie  Torgersen           39.5          17.4               186        3800 female  2007 FALSE\n##  3 Adelie  Torgersen           40.3          18                 195        3250 female  2007 FALSE\n##  4 Adelie  Torgersen           NA            NA                  NA          NA <NA>    2007 NA   \n##  5 Adelie  Torgersen           36.7          19.3               193        3450 female  2007 FALSE\n##  6 Adelie  Torgersen           39.3          20.6               190        3650 male    2007 FALSE\n##  7 Adelie  Torgersen           38.9          17.8               181        3625 female  2007 FALSE\n##  8 Adelie  Torgersen           39.2          19.6               195        4675 male    2007 FALSE\n##  9 Adelie  Torgersen           34.1          18.1               193        3475 <NA>    2007 FALSE\n## 10 Adelie  Torgersen           42            20.2               190        4250 <NA>    2007 FALSE\n## # ‚Ä¶ with 334 more rows"},{"path":"workflow.html","id":"workflow","chapter":"2 Workflow","heading":"2 Workflow","text":"notes generally assume ‚Äôll sort linear regression,\nfirst couple steps workflow applicable analyses\nhelp figure kind analysis want .","code":""},{"path":"workflow.html","id":"overview","chapter":"2 Workflow","heading":"2.1 Overview","text":"Decide question(s)Helps guide exploration modelsPreliminary data explorationHelps determine answers questions guide model developmentDecide modelRun modelCheck model diagnosticsInterpret model","code":""},{"path":"data-exploration.html","id":"data-exploration","chapter":"3 Data Exploration","heading":"3 Data Exploration","text":"‚Äôs good idea take moment write things want know \nstudy.relationship penguin size sex?take another moment see can even specific.\nwant start linking specific variables data specific questions related want know.let‚Äôs use size, measured body mass grams (body_mass_g)female penguins larger males? (sex)depend species? (species)think variables aren‚Äôt main interest, might still influence (see Mixed Models details terms )effect island? (island)care specific island? (island fixed factor)want account sampling design across islands? (island random factor)specific can , easier explore data run models.first step visual exploration data, ‚Äôre two reasons:see can visually answer questions (statistically answer models)learn data, can choose right model.","code":""},{"path":"linear-models.html","id":"linear-models","chapter":"4 Linear Models","heading":"4 Linear Models","text":"","code":""},{"path":"linear-models.html","id":"preamble","chapter":"4 Linear Models","heading":"4.1 Preamble","text":"‚Äôre talking linear relationships. plenty types models (e.g., exponential) deal non-linear relationships mix linear non-linear (e.g., GAMs).Disclaimer:models included examples, ‚Äôre best (sensible) questions ask, often explore correlated features rather features might actually assume causation.Technically might better explored using Standardised Major Axis Estimate (SMA) smatr package. now, ‚Äôll suffice üòÅ","code":"\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(patchwork) # putting figures together\nlibrary(car) # For Anova() and vif() functions"},{"path":"linear-models.html","id":"general-workflow","chapter":"4 Linear Models","heading":"4.2 General Workflow","text":"Decide question(s)Preliminary data explorationDecide model (linear model, generalized linear model, mixed model, etc.)Run modelCheck model diagnosticsInterpret model","code":""},{"path":"linear-models.html","id":"simple-lms-in-r","chapter":"4 Linear Models","heading":"4.3 (Simple) LMs in R","text":"","code":""},{"path":"linear-models.html","id":"requirements","chapter":"4 Linear Models","heading":"Requirements","text":"Continuous response (y)\ncount data, binary (binomial) data, proprotions (although transformed)\ncount data, binary (binomial) data, proprotions (although transformed)Continuous categorical predictors (x1, x2, etc.)","code":""},{"path":"linear-models.html","id":"assumptions","chapter":"4 Linear Models","heading":"Assumptions","text":"Linear relationship y xs.Independence - Observations independent (.e.¬†residuals independent)\nhierarchical sampling, nested designs, variables based \nhierarchical sampling, nested designs, variables based otherNormality - Residuals normally distributedConstant variance - constant variance residuals (heteroscedasticity)","code":""},{"path":"linear-models.html","id":"cautions","chapter":"4 Linear Models","heading":"Cautions","text":"MulticollinearityInfluenceSee Diagnostics section details","code":""},{"path":"linear-models.html","id":"types-of-models","chapter":"4 Linear Models","heading":"Types of models","text":"Regression - Continuous predictor (x)Multiple regression - one continuous predictor\n(x1, x2, ‚Ä¶)ANOVA - Categorical predictor(s) (x1, x2, ‚Ä¶)ANCOVA - Mix categorical continuous predictors (x1, x2, ‚Ä¶)","code":""},{"path":"linear-models.html","id":"run-models-with-lm","chapter":"4 Linear Models","heading":"Run models with lm()","text":"lm(y ~ x1 + x2, data = data)R figure underlying model type (regression, ANOVA, ANCOVA etc.)Store model object, mm model objectThis contains information modelUse summary() show summary table:Use anova() show Anova table (Type ), , better, Anova() (car package) use type II III:","code":"\nm <- lm(body_mass_g ~ bill_depth_mm, data = penguins)\nclass(m)## [1] \"lm\"\nsummary(m)## \n## Call:\n## lm(formula = body_mass_g ~ bill_depth_mm, data = penguins)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1607.38  -510.10   -66.96   462.43  1819.28 \n## \n## Coefficients:\n##               Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)    7488.65     335.22   22.34   <2e-16 ***\n## bill_depth_mm  -191.64      19.42   -9.87   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 708.1 on 340 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:  0.2227, Adjusted R-squared:  0.2204 \n## F-statistic: 97.41 on 1 and 340 DF,  p-value: < 2.2e-16\nAnova(m, type = \"III\")## Anova Table (Type III tests)\n## \n## Response: body_mass_g\n##                  Sum Sq  Df F value    Pr(>F)    \n## (Intercept)   250215572   1 499.060 < 2.2e-16 ***\n## bill_depth_mm  48840779   1  97.414 < 2.2e-16 ***\n## Residuals     170466918 340                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"linear-models.html","id":"summary-tables-vs.-anova-tables","chapter":"4 Linear Models","heading":"Summary tables vs.¬†ANOVA tables","text":"NOTE\nEven though traditionally summary table used evaluate regression \nANOVA table used evaluate ANOVA ANCOVA, can used\nassess linear model, just ask slightly different questionsSummary tablesSummary tables show results specific statistical questions.\nprecise interpretation results depends whether parameters\ncontinuous, categorical, mix, whether interactions .\n(see specific sections interpretations).ANOVA tablesBroadly, ANOVA table asks whether overall effect \nparameter, specify effect .means continuous parameters don‚Äôt know effect \npositive negative.categorical parameters don‚Äôt know category effect\n(see Post-Hoc analyses can used tease apart).","code":""},{"path":"linear-models.html","id":"regressions","chapter":"4 Linear Models","heading":"4.4 Regressions","text":"Continuous response (y) continuous predictor(s) (x)might interested ?","code":""},{"path":"linear-models.html","id":"create-model","chapter":"4 Linear Models","heading":"Create Model","text":"see relationships significant run/create linear model‚Ä¶Wait! shouldn‚Äôt interpret ‚Äôve checked diagnostics","code":"\nm <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm, data = penguins)"},{"path":"linear-models.html","id":"model-diagnostics","chapter":"4 Linear Models","heading":"Model Diagnostics","text":"Checking Assumptions\nNormality (residuals)\nConstant Variance (heteroscedasticity)\nNormality (residuals)Constant Variance (heteroscedasticity)cautions\nInfluential observations (Cook‚Äôs D)\nMultiple collinearity (one x explanatory variables)\nInfluential observations (Cook‚Äôs D)Multiple collinearity (one x explanatory variables)See Diagnostics section details","code":"\nd <- data.frame(residuals = residuals(m),    \n                std_residuals = rstudent(m), \n                fitted = fitted(m),          \n                cooks = cooks.distance(m)) %>%\n  mutate(obs = 1:n())"},{"path":"linear-models.html","id":"normality-and-heteroscedasticity","chapter":"4 Linear Models","heading":"Normality and Heteroscedasticity","text":"","code":"\ng1 <- ggplot(data = d, aes(x = std_residuals)) +\n  geom_histogram(bins = 20) +\n  ggtitle(\"Histogram of residuals\")\n\ng2 <- ggplot(data = d, aes(sample = std_residuals)) +\n  stat_qq() +\n  stat_qq_line() +\n  ggtitle(\"QQ Normality plot of residuals\")\n\ng3 <- ggplot(d, aes(x = fitted, y = std_residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0) +\n  ggtitle(\"Heteroscedacity: Residuals vs. fitted\")\n\n(g1 + g2) / g3"},{"path":"linear-models.html","id":"influence","chapter":"4 Linear Models","heading":"Influence","text":"Cook‚Äôs DPretty good!","code":"\nggplot(d, aes(x = obs, y = cooks)) +\n  geom_point() +\n  geom_hline(yintercept = 1, linetype = \"dotted\") +\n  geom_hline(yintercept = 4/nrow(penguins), \n             linetype = \"dashed\") +\n  ggtitle(\"Cook's D: Influential observations\")"},{"path":"linear-models.html","id":"multicollinearity-collinearity","chapter":"4 Linear Models","heading":"Multicollinearity (collinearity)","text":"Look two explanatory variablesDefinitely correlated.\nneed investigate interferes model.Use vif() function car package1Hmm, ‚Äôs pretty good (looking < 10).can assume correlation problem interpret model","code":"\nggplot(data = penguins, aes(x = flipper_length_mm, y = bill_length_mm)) +\n  geom_point() +\n  stat_smooth(method = \"lm\")\nlibrary(car)\nvif(m)## flipper_length_mm    bill_length_mm \n##          1.756154          1.756154"},{"path":"linear-models.html","id":"summary-tables","chapter":"4 Linear Models","heading":"Summary Tables","text":"‚Äôs lot information! Let‚Äôs break .ModelMissing observationsR2 adjusted R2Adjusted number parametersEffects","code":"\nm <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm, data = penguins)\nsummary(m)## \n## Call:\n## lm(formula = body_mass_g ~ flipper_length_mm + bill_length_mm, \n##     data = penguins)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -1090.5  -285.7   -32.1   244.2  1287.5 \n## \n## Coefficients:\n##                    Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)       -5736.897    307.959 -18.629   <2e-16 ***\n## flipper_length_mm    48.145      2.011  23.939   <2e-16 ***\n## bill_length_mm        6.047      5.180   1.168    0.244    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 394.1 on 339 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7585 \n## F-statistic: 536.6 on 2 and 339 DF,  p-value: < 2.2e-16## Call:\n## lm(formula = body_mass_g ~ flipper_length_mm + bill_length_mm, \n##     data = penguins)##   (2 observations deleted due to missingness)## Multiple R-squared:   0.76,  Adjusted R-squared:  0.7585 ##                    Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)       -5736.897    307.959 -18.629   <2e-16 ***\n## flipper_length_mm    48.145      2.011  23.939   <2e-16 ***\n## bill_length_mm        6.047      5.180   1.168    0.244    "},{"path":"linear-models.html","id":"interpreting-effects","chapter":"4 Linear Models","heading":"Interpreting effects","text":"Intercept\nSignificant (P = < 2.2e-16)\nPenguins flipper length 0 mm bill length 0 mm predicted body mass -5736.9 g\nSignificant (P = < 2.2e-16)Penguins flipper length 0 mm bill length 0 mm predicted body mass -5736.9 gFlipper Length\nSignificant (P = < 2.2e-16)\n1 mm increase flipper length, body mass predicted increase 48.14 g\nSignificant (P = < 2.2e-16)1 mm increase flipper length, body mass predicted increase 48.14 gBill Length\nNon-significant (P = 0.244)\ndon‚Äôt interpret)\nNon-significant (P = 0.244)don‚Äôt interpret)(Note: 2e-16 = 0.0000000000000002, R uses smallest number)ThereforeThere significant relationship flipper length body mass.\nbill length body mass (including controlling \nflipper length)","code":"##                    Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)       -5736.897    307.959 -18.629   <2e-16 ***\n## flipper_length_mm    48.145      2.011  23.939   <2e-16 ***\n## bill_length_mm        6.047      5.180   1.168    0.244    "},{"path":"linear-models.html","id":"interpreting-the-effects-as-a-model","chapter":"4 Linear Models","heading":"Interpreting the effects as a model","text":"First general equation line4.\\(y = mx + b\\)\\(m\\) = slope \\(x\\)\\(b\\) = interceptFor two explanatory variables\\(y = m_1x_1 + m_2x_2 + b\\)specific model\\(y = 48.14x_1 + 6.05x_2 + (-5736.9)\\)","code":""},{"path":"linear-models.html","id":"extra","chapter":"4 Linear Models","heading":"Extra","text":"effect Bill Length? {-}hypothesis causation really, just correlationFlipper length ‚Äòbetter‚Äô predictor body massWhen flipper length model, extra variation explained bill lengthWhen flipper length model, variation left explained","code":"\nm <- lm(body_mass_g ~ bill_length_mm, data = penguins)\nsummary(m)## \n## Call:\n## lm(formula = body_mass_g ~ bill_length_mm, data = penguins)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1762.08  -446.98    32.59   462.31  1636.86 \n## \n## Coefficients:\n##                Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)     362.307    283.345   1.279    0.202    \n## bill_length_mm   87.415      6.402  13.654   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 645.4 on 340 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:  0.3542, Adjusted R-squared:  0.3523 \n## F-statistic: 186.4 on 1 and 340 DF,  p-value: < 2.2e-16\nm <- lm(body_mass_g ~ bill_length_mm, data = penguins)\nsummary(m)## \n## Call:\n## lm(formula = body_mass_g ~ bill_length_mm, data = penguins)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -1762.08  -446.98    32.59   462.31  1636.86 \n## \n## Coefficients:\n##                Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)     362.307    283.345   1.279    0.202    \n## bill_length_mm   87.415      6.402  13.654   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 645.4 on 340 degrees of freedom\n##   (2 observations deleted due to missingness)\n## Multiple R-squared:  0.3542, Adjusted R-squared:  0.3523 \n## F-statistic: 186.4 on 1 and 340 DF,  p-value: < 2.2e-16"},{"path":"linear-models.html","id":"anovas","chapter":"4 Linear Models","heading":"4.5 ANOVAs","text":"Continuous response (y) categorical predictor(s) (x)might interested ?","code":""},{"path":"linear-models.html","id":"create-model-1","chapter":"4 Linear Models","heading":"Create Model","text":"see relationships significant run/create linear model‚Ä¶first diagnostics‚Ä¶","code":"\nm <- lm(body_mass_g ~ species + sex, data = penguins)"},{"path":"linear-models.html","id":"model-diagnostics-1","chapter":"4 Linear Models","heading":"Model Diagnostics","text":"regressions‚Ä¶Checking Assumptions\nNormality (residuals)\nConstant Variance (heteroscedasticity)\nNormality (residuals)Constant Variance (heteroscedasticity)cautions\nInfluential observations (Cook‚Äôs D)\nMultiple collinearity (one x explanatory variables)\nInfluential observations (Cook‚Äôs D)Multiple collinearity (one x explanatory variables)See Diagnostics section details","code":"\nd <- data.frame(residuals = residuals(m),    \n                std_residuals = rstudent(m), \n                fitted = fitted(m),          \n                cooks = cooks.distance(m))   \n\nd <- mutate(d, obs = 1:n())\nhead(d)##    residuals std_residuals   fitted        cooks obs\n## 1 -289.94196    -0.9201062 4039.942 0.0021071103   1\n## 2  427.61319     1.3590567 3372.387 0.0045831843   2\n## 3 -122.38681    -0.3879729 3372.387 0.0003754346   3\n## 5   77.61319     0.2460043 3372.387 0.0001509858   4\n## 6 -389.94196    -1.2387413 4039.942 0.0038112292   5\n## 7  252.61319     0.8013974 3372.387 0.0015994740   6"},{"path":"linear-models.html","id":"normality-and-heteroscedasticity-1","chapter":"4 Linear Models","heading":"Normality and Heteroscedasticity","text":"","code":"\ng1 <- ggplot(data = d, aes(x = std_residuals)) +\n  geom_histogram(bins = 20)\n\ng2 <- ggplot(data = d, aes(sample = std_residuals)) +\n  stat_qq() +\n  stat_qq_line()\n\ng3 <- ggplot(d, aes(x = fitted, y = std_residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0)\n\n(g1 + g2) / g3"},{"path":"linear-models.html","id":"influence-1","chapter":"4 Linear Models","heading":"Influence","text":"Cook‚Äôs DOverall bad","code":"\nggplot(d, aes(x = obs, y = cooks)) +\n  geom_point() +\n  geom_hline(yintercept = 1, linetype = \"dotted\") + #<<\n  geom_hline(yintercept = 4/nrow(penguins), \n             linetype = \"dashed\")"},{"path":"linear-models.html","id":"multicollinearity-collinearity-1","chapter":"4 Linear Models","heading":"Multicollinearity (collinearity)","text":"relevant one explanatory variableSometimes explanatory variables correlated interfere modelCorrelations variables might problematic (necessarily)Use vif() function car package5Here consider GVIF^(1/2*Df)) value*Looks good!(* See ?vif reference therein: Fox, J. Monette, G. (1992) Generalized collinearity diagnostics. JASA, 87, 178‚Äì183.)","code":"\nlibrary(car)\nvif(m)##             GVIF Df GVIF^(1/(2*Df))\n## species 1.000146  2        1.000036\n## sex     1.000146  1        1.000073"},{"path":"linear-models.html","id":"summary-tables-1","chapter":"4 Linear Models","heading":"Summary Tables","text":"‚Äôs lot information! Let‚Äôs break .ModelMissing observationsR2 adjusted R2Adjusted number parametersEffects","code":"\nm <- lm(body_mass_g ~ species + sex, data = penguins)\nsummary(m)## \n## Call:\n## lm(formula = body_mass_g ~ species + sex, data = penguins)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -816.87 -217.80  -16.87  227.61  882.20 \n## \n## Coefficients:\n##                  Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)       3372.39      31.43 107.308   <2e-16 ***\n## speciesChinstrap    26.92      46.48   0.579    0.563    \n## speciesGentoo     1377.86      39.10  35.236   <2e-16 ***\n## sexmale            667.56      34.70  19.236   <2e-16 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 316.6 on 329 degrees of freedom\n##   (11 observations deleted due to missingness)\n## Multiple R-squared:  0.8468, Adjusted R-squared:  0.8454 \n## F-statistic: 606.1 on 3 and 329 DF,  p-value: < 2.2e-16## Call:\n## lm(formula = body_mass_g ~ species + sex, data = penguins)##   (11 observations deleted due to missingness)## Multiple R-squared:  0.8468, Adjusted R-squared:  0.8454 ##                  Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)       3372.39      31.43 107.308   <2e-16 ***\n## speciesChinstrap    26.92      46.48   0.579    0.563    \n## speciesGentoo     1377.86      39.10  35.236   <2e-16 ***\n## sexmale            667.56      34.70  19.236   <2e-16 ***"},{"path":"linear-models.html","id":"interpreting-effects-1","chapter":"4 Linear Models","heading":"Interpreting effects","text":"Estimate\nTreatment contrasts\nAverage differences among categories compared base category\nTreatment contrastsAverage differences among categories compared base categoryStd. Error\nVariability estimates\nVariability estimatest value\nTest statistic\nTest statisticPr(>|t|)\nP-value, significance differences\nProbability getting t-value chance\nP-value, significance differencesProbability getting t-value chanceEasier interpret estimates consider simpler modelA simpler modelEffect Species(Intercept) represents base category (.e.¬†Adelie penguins)Adelie mean body mass 3700.66 gOn average, Chinstrap penguins 32.43 g heavier Adelie penguinsOn average, Gentoo penguins 1375.35 g heavier Adelie penguinsBack original modelEffect Species Sex(Intercept) represents base category combination factorsMuch complicated interpretComparisons often interest anyway\n(unless ‚Äôve set contrasts, advanced stats awesome!)let‚Äôs look ANOVA tables instead","code":"## (Intercept)       3372.39      31.43 107.308   <2e-16 ***\n## speciesChinstrap    26.92      46.48   0.579    0.563    \n## speciesGentoo     1377.86      39.10  35.236   <2e-16 ***\n## sexmale            667.56      34.70  19.236   <2e-16 ***\nm <- lm(body_mass_g ~ species, data = penguins)\nsummary(m)## (Intercept)       3700.66      37.62   98.37   <2e-16 ***\n## speciesChinstrap    32.43      67.51    0.48    0.631    \n## speciesGentoo     1375.35      56.15   24.50   <2e-16 ***\nm <- lm(body_mass_g ~ species + sex, data = penguins)## (Intercept)       3372.39      31.43 107.308   <2e-16 ***\n## speciesChinstrap    26.92      46.48   0.579    0.563    \n## speciesGentoo     1377.86      39.10  35.236   <2e-16 ***\n## sexmale            667.56      34.70  19.236   <2e-16 ***"},{"path":"linear-models.html","id":"anova-tables","chapter":"4 Linear Models","heading":"ANOVA Tables","text":"","code":""},{"path":"linear-models.html","id":"type-i","chapter":"4 Linear Models","heading":"4.5.0.1 Type I","text":"","code":"\nanova(m)## Analysis of Variance Table\n## \n## Response: body_mass_g\n##            Df    Sum Sq  Mean Sq F value    Pr(>F)    \n## species     2 145190219 72595110  724.21 < 2.2e-16 ***\n## sex         1  37090262 37090262  370.01 < 2.2e-16 ***\n## Residuals 329  32979185   100241                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"linear-models.html","id":"type-iii","chapter":"4 Linear Models","heading":"Type III","text":"Anova() car package.Overall effects Species SexYes differences among Species (P < 2.2e-16)Yes differences Sexes (P < 2.2e-16)whole lot information‚Ä¶ ‚Äôll Post-Hoc tests!","code":"\nAnova(m, type = \"3\")## Anova Table (Type III tests)\n## \n## Response: body_mass_g\n##                 Sum Sq  Df  F value    Pr(>F)    \n## (Intercept) 1154266972   1 11514.96 < 2.2e-16 ***\n## species      143401584   2   715.29 < 2.2e-16 ***\n## sex           37090262   1   370.01 < 2.2e-16 ***\n## Residuals     32979185 329                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"linear-models.html","id":"type-i-vs.-iii","chapter":"4 Linear Models","heading":"Type I vs.¬†III","text":"one ?Type ANOVAs, order matters unbalanced samples\nSee Sum sq, Mean Sq F value differ models\nSee Sum sq, Mean Sq F value differ modelsHere, pretty minor, important remember greater unbalancesType III ANOVAs dependent variable orderType II ANOVAs exist well, generally use Type III natural sciences","code":"\nm1 <- lm(body_mass_g ~ species + sex, data = penguins) #<<\nanova(m1)## Analysis of Variance Table\n## \n## Response: body_mass_g\n##            Df    Sum Sq  Mean Sq F value    Pr(>F)    \n## species     2 145190219 72595110  724.21 < 2.2e-16 ***\n## sex         1  37090262 37090262  370.01 < 2.2e-16 ***\n## Residuals 329  32979185   100241                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nm2 <- lm(body_mass_g ~ sex + species, data = penguins)#<<\nanova(m2)## Analysis of Variance Table\n## \n## Response: body_mass_g\n##            Df    Sum Sq  Mean Sq F value    Pr(>F)    \n## sex         1  38878897 38878897  387.86 < 2.2e-16 ***\n## species     2 143401584 71700792  715.29 < 2.2e-16 ***\n## Residuals 329  32979185   100241                      \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1## Anova Table (Type III tests)\n## \n## Response: body_mass_g\n##                 Sum Sq  Df  F value    Pr(>F)    \n## (Intercept) 1154266972   1 11514.96 < 2.2e-16 ***\n## species      143401584   2   715.29 < 2.2e-16 ***\n## sex           37090262   1   370.01 < 2.2e-16 ***\n## Residuals     32979185 329                       \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"linear-models.html","id":"post-hoc-tests","chapter":"4 Linear Models","heading":"Post-Hoc tests","text":"like understand differences 2+ levels categorical variable, ‚Äôll need post-hoc tests.Note:post-hoc tests found significant variable ANOVA table.‚Äôs point post-hoc tests unless variable three levels, ‚Äôre interested understanding differences among categorical variables also interactionIn example, don‚Äôt need post-hoc tests sex, two levels, male female. difference, males different females, question.","code":""},{"path":"appendix-model-diagnostics.html","id":"appendix-model-diagnostics","chapter":"Appendix Model Diagnostics","heading":"Appendix Model Diagnostics","text":"many different kinds model checking/diagnostics need used different kinds models.normally distributed residuals (gaussian)constant variance residuals (gaussian)checking influential observations ()assessing multiple collinearity ()overdispersion (poisson binomial)DHARMa package assessing model fit using simulated residuals ()section cover run interpret various diagnostics\ncan used different types models.","code":"\nlibrary(tidyverse)\nlibrary(palmerpenguins)\nlibrary(car)\n\nlibrary(lme4)\nlibrary(glmmTMB)"},{"path":"appendix-model-diagnostics.html","id":"diagnostics-by-hand","chapter":"Appendix Model Diagnostics","heading":"Diagnostics by hand","text":"many functions checking diagnostics R generally work specific model types.However, many diagnostics simply require fitted values (model predictions)\nresiduals (model errors) can extract use create \ndiagnostic plots.","code":""},{"path":"appendix-model-diagnostics.html","id":"extracting-parameters","chapter":"Appendix Model Diagnostics","heading":"Extracting parameters","text":"residuals()fitted() valuescooks.distance().numeric(names(residuals())) Observation number\n(accounting omitted, missing values)\n(accounting omitted, missing values)","code":"\nm <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm, data = penguins)\nd <- tibble(residuals = residuals(m),    \n            fitted = fitted(m),          \n            cooks = cooks.distance(m),\n            obs = as.numeric(names(residuals)))\nhead(d)## # A tibble: 6 √ó 4\n##   residuals fitted        cooks   obs\n##       <dbl>  <dbl>        <dbl> <dbl>\n## 1    536.    3214. 0.00554          1\n## 2    343.    3457. 0.00161          2\n## 3   -645.    3895. 0.00380          3\n## 4   -327.    3777. 0.00199          5\n## 5      1.71  3648. 0.0000000334     6\n## 6    412.    3213. 0.00327          7"},{"path":"appendix-model-diagnostics.html","id":"normality","chapter":"Appendix Model Diagnostics","heading":"Normality","text":"QQ Normality plot residuals","code":"\nggplot(data = d, aes(sample = residuals)) +\n  stat_qq() +\n  stat_qq_line()"},{"path":"appendix-model-diagnostics.html","id":"variance","chapter":"Appendix Model Diagnostics","heading":"Variance","text":"Check heteroscedasticity","code":"\nggplot(d, aes(x = fitted, y = residuals)) +\n  geom_point() +\n  geom_hline(yintercept = 0)"},{"path":"appendix-model-diagnostics.html","id":"influence-cooks-d","chapter":"Appendix Model Diagnostics","heading":"Influence (Cook‚Äôs D)","text":"observation unusually high effect modelIf omit observation entire model changes, observation said lot influenceCook‚Äôs D way measuring influenceUse ggiraph get interactive tooltips (hover point find !)","code":"\nggplot(d, aes(x = obs, y = cooks)) +\n  geom_point()\nlibrary(ggiraph)\ng <- ggplot(d, aes(x = obs, y = cooks)) +\n  geom_point_interactive(aes(tooltip = obs))\ngirafe(ggobj = g, width_svg = 6, height_svg = 3)"},{"path":"appendix-model-diagnostics.html","id":"mixed-models","chapter":"Appendix Model Diagnostics","heading":"Mixed models","text":"addition observation level effects () ‚Äôll also want take\nlook random effectsQQ Normality plot random effects","code":"\nm <- lmer(body_mass_g ~ flipper_length_mm + bill_length_mm + (1|island), data = penguins)\n\nr <- as.data.frame(ranef(m))\nggplot(data = r, aes(sample = condval)) +\n  stat_qq() +\n  stat_qq_line()"},{"path":"appendix-model-diagnostics.html","id":"multicollinearity","chapter":"Appendix Model Diagnostics","heading":"Multicollinearity","text":"relevant one explanatory variableSometimes explanatory variables correlated interfere might interpret \nNote means variables included covariates\n(.e.¬†control effects, want interpret ),\ncan highly correlated correlation won‚Äôt affect \nparameters model8\nNote means variables included covariates\n(.e.¬†control effects, want interpret ),\ncan highly correlated correlation won‚Äôt affect \nparameters model8Correlations variables might problematic (necessarily)Use vif() function car package9Interpreting VIF1 means correlation1-5 means moderate probably problem5-10 problematic, p-values may longer valid\n10 FIX!\n10 FIX!","code":"\nvif(m)## flipper_length_mm    bill_length_mm \n##          1.872981          1.872981"},{"path":"appendix-model-diagnostics.html","id":"overdispersion","chapter":"Appendix Model Diagnostics","heading":"Overdispersion","text":"Coming!","code":""},{"path":"appendix-model-diagnostics.html","id":"dharma","chapter":"Appendix Model Diagnostics","heading":"DHARMa","text":"","code":"\nlibrary(DHARMa)\n\nr <- simulateResiduals(m, plot = TRUE)\nm <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm + species, data = penguins)\nr <- simulateResiduals(m, plot = TRUE)\nm <- lm(body_mass_g ~ flipper_length_mm + bill_length_mm + species * sex, data = penguins)\nr <- simulateResiduals(m, plot = TRUE)"},{"path":"appendix-model-diagnostics.html","id":"dharma-is-applicable-to-most-linear-models","chapter":"Appendix Model Diagnostics","heading":"DHARMa is applicable to most linear models","text":"","code":"\npenguins <- mutate(penguins, \n                   size = flipper_length_mm > median(flipper_length_mm, na.rm = TRUE))\n\nm <- glm(size ~ species, family = \"binomial\", data = penguins)\nr <- simulateResiduals(m, plot = TRUE)"},{"path":"appendix-further-reading.html","id":"appendix-further-reading","chapter":"Appendix Further Reading","heading":"Appendix Further Reading","text":"","code":""},{"path":"appendix-further-reading.html","id":"diagnostics","chapter":"Appendix Further Reading","heading":"Diagnostics","text":"Can Safely Ignore Multicollinearity?","code":""},{"path":"appendix-further-reading.html","id":"interaction-terms","chapter":"Appendix Further Reading","heading":"Interaction Terms","text":"center variables, can interpret main effects interaction (Schielzeth 2010)","code":""},{"path":"appendix-further-reading.html","id":"adjusted-p-values","chapter":"Appendix Further Reading","heading":"Adjusted P-values","text":"Use Benjamini-Hochberg (False Discovery Rate, FDR) P-value adjustment, Bonferroni (Nakagawa 2004)","code":""},{"path":"appendix-further-reading.html","id":"mixed-models-1","chapter":"Appendix Further Reading","heading":"Mixed Models","text":"Use random slopes can (Schielzeth Forstmeier 2009)MuMIn package calculates R2 mixed models Nakagawa, Johnson, Schielzeth (2017)lmerTest package calculates P-values based Satterthwaite‚Äôs method approximating degrees freedom t F tests (Kuznetsova, Brockhoff, Christensen 2017)","code":""},{"path":"appendix-further-reading.html","id":"references","chapter":"Appendix Further Reading","heading":"References","text":"","code":""}]
